# 인덱스

- 데이터를 빠르게 찾을 수 있는 장치
- 컬럼의 값과 해당 레코드가 저장된 주소를 키와 값의 쌍으로 인덱스를 만들어두어 데이터 검색 속도를 향상

# B-트리

<p align="center">
<img src="./image/B-%ED%8A%B8%EB%A6%AC%20%EC%98%88%EC%A0%9C%201.png" width="400px">
</p>

</br>

<p align="center">
<img src="./image/B-%ED%8A%B8%EB%A6%AC%20%EC%98%88%EC%A0%9C%202.png" width="400px">
</p>

## 인덱스가 효율적인 이유와 대수확장성

- 효율적인 단계를 거쳐 모든 요소에 접근할 수 있는 균형 잡힌 트리 구조와 트리 깊이의 대수확장성 때문
- 대수확장성
  - 트리 깊이가 리프 노드 수에 비해 매우 느리게 성장하는 것을 의미
  - 기본적으로 한 깊이씩 증가할 때마다 최대 인덱스 항목의 수는 4배씩 증가

### Index를 사용하면 좋은 경우

- Where 절에서 자주 사용되는 컬럼
- 외래키가 사용되는 컬럼
- Join에 자주 사용되는 컬럼

### Index 사용을 피해야 하는 경우

- Data 중복도가 높은 컬럼
- DML이 자주 일어나는 컬럼

## Index 장점

- 키 값을 기초로 하여 테이블에서 검색과 정렬 속도를 향상시킨다.
- 인덱스를 사용하면 테이블 행의 고유성을 강화시킬 수 있다.
- 테이블의 기본 키는 자동으로 인덱싱된다.
- 필드 중에는 테이블 형식 때문에 인덱싱 할 수 없는 필드도 있다.
- 여러 필드로 이루어진 다중 필드 인덱스를 사용하면 첫 필드 값이 같은 레코드도 구분할 수 있다._cf. 액세스에서 다중 필드 인덱스는 최대 10개의 필드를 포함할 수 있다._

## Index 단점

- 인덱스를 만들면 .mdb 파일 크기가 늘어난다.
- 사용자가 한 페이지를 동시에 수정할 수 있는 병행성이 줄어든다.
- 인덱스된 필드에서 **데이터를 업데이트 하거나 레코드를 추가 또는 삭제할 때 성능이 떨어진다**.
- 인덱스가 데이터베이스 공간을 차지해 추가적인 공간이 필요하다. DB의 10% 내외의 공간이 추가로 필요하다.
- **데이터 변경 작업이 자주 일어나는 경우에 인덱스를 재작성해야 할 필요가 있기에 성능에 영향을 끼칠 수 있다.**

위와 같은 단점들 때문에 어느 필드를 인덱싱할지 미리 시험해본 후에 결정하는 것이 좋다.
인덱스를 추가하여 쿼리 속도가 1초 정도 빨라진다면 데이터 행을 추가하는 속도는 2초정도 느려지고, 이 경우 여러 사용자가 사용한다면 **레코드 잠금** 문제가 발생할 수 있다.

## 💡 **레코드 잠금**

> **데이터에 대한 동시 액세스를 방지하는 기술** > **일관성 없는 결과를 방지**
>
> 같은 레코드를 수정하는 트랜잭션 2개가 동시에 시작되었을 때, 나중에 끝난 트랜잭션이 먼저 끝난 트랜잭션의 결과를 덮어씌워, 먼저 끝난 트랜잭션을 무효화시킨다. 이러한 결과를 방지하기 위해 하나의 트랜잭션이 끝날 때까지 레코드를 잠궈 다른 트랜잭션의 접근을 막는다.
